# 전송 계층

- 전송계층: 네트워크/ 응용계층 사이에 위치
    - 기능: 네트워크 계층 IP 한계를 극복, 응용 계층에서 동작하는 어플리케이션 프로세스를 식별하는 것임

- IP 프로토콜: 신뢰할 수 없는 통신과 비연결형 통신을 제공함
    - 신뢰할 수 없는 통신은 패킷이 수신지까지 제대로 전송되었다는 보장을 하지 않음
    - 비연결형 통신은 송수신지 간의 사전 연결 수립없이 패킷을 주고받는 특성을 가짐 

- TCP와 UDP 프로토콜
    - TCP:신뢰할 수 이쓴ㄴ 연결형 통신을 제공, 송수신 호스트 간의 연결수립과 종료를 포함
    - UDP: 신뢰할 수 없는 비연결형 통신을 제공, 빠른 송수신 가능 

- 포트: 패킷이 실행 중인 특정 애플리케이션까지 전달되려면 패킷에 특정 애플리케이션을 식별할 수 있는 정보가 포함되어야하는 데 이를 포트라고 함.

    - 0~1023번: 범용적으로 사용되는 시스템 포트
        - DNS(53), HTTP(80), HTTPS(443), FTP(20,21)

    - 1024~49151: 등록된 포트, 흔히 사용되는 애플리케이션 프로토콜에 할당
        - 특정 기업이나 오픈소스에서 자주 사용됨됨

    - 49152~ 65535: 자유롭게 사용가능
        - 클라이언트 프로그램은 대부분 동적 포트사용하여 통신, 
        ex) 브라우저는 HTTP서버와 통신할 때 동적 포트를 사용하여 송신지 포트를 명시시

    - 네트워크에서 특정 컴퓨터가 실행하는 프로세스를 식별하는 정보
    TCP와 UDP페킷 헤더에 수신지 포트와 송신지포트가 포함되어 있음

- 포트 포워딩: 네트워크 내부 특정 호스트에 외부 접근이 가능하도록 해주는 기술
    - 외부호스트는 목적지 IP주소와 포트 번호를 알아야 함
    - 특정 호스트에 IP주소와 포트 번호 쌍을 미리 할당하고, 해당 정보로 패킷을 전달함
            
- NAT와 포트 기반 NAT
    - NAT: IP주소 변환 기술, 포트기반 NAT는 공인 IP주소 낭비 방지

- TCP와 UDP 비교
    - TCP 특징: 흐름 제어, 혼잡 제어, 오류 제어
    - 사용 예: 웹 브라우징, 이메일, 파일 전송
    - UDP 특징: 빠른 데이터 전송 가능/ 신뢰성 없음
    - 사용 예: 실시간 스트리밍, 인터넷전화, 온라인 게임

- TCP
    - 연결 지향형 프로토콜, 세션 수립 후 데이터 전송
    - 순서 보장 및 오류 복구 기능 제공
    - MSS(최대 세그먼트 크기): 전송 가능 최대 데이터 크기
    - MTU(최대 전송 단위): 네트워크 인터페이스에서 전송 가능 최대 크기
    - 헤더 구조
        - 송신지/수신지 포트 번호: 실행 중인 프로세스슬 식별하는 16비트 번호 
        - 순서 번호: 데이터의 올바른 순서 보장
        - 확인 응답 번호: 수신자가 기대하는 다음 순서 번호
        - 제어 비트: TCP 연결 및 종료 관리( SYN:연결 요청, ACK:응답 확인, FIN: 연결 종료료)
- UDP
    - 송신지, 수신지 포트: 송수신지의 포트 번호
    - 체크섬: 오류 발생 체크, 오류 있다고 판단하면 폐기

- TCP, UDP 차이점
    - TCP 연결 설정 상태
    - Close Wait/ Time Wait: 종료 과정에서 일정 시간 대기
    - UDP는 상태 정보 없음, TCP는 상태 기반